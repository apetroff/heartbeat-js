[{
	"path": "users",
	"workflows": [{
		"path": "list.json",
		"prepare": ["session", "user"],
		"tasks": [{
			"functionName": "parseQuery",
			"url": "{$request.url}",
			"user": "{$request.user}",
			"produce": "data.query"
		}, {
			"className":  "task/mongoRequest",
			"connector":  "mongo",
			"pager": "{$data.query}",
			"options": {
				"fields": {
					"shared":0
				}
			},
			"collection": "users",
			"produce":    "data.records"
		}],
		"presenter": {
			"type": "json",
			"vars": "{$data.records}"
		}
	}, {
		"path": "create.json",
		"prepare": ["session", "user"],
		"tasks": [{
			"functionName": "addUserData",
			"data": "{$request.body.fields}",
			"user": "{$request.user}",
			"produce": "data.personalData"
		}, {
			"className":  "task/mongoRequest",
			"connector":  "mongo",
			"method":     "insert",
			"collection": "users",
			"data":       "{$data.personalData}",
			"produce":    "data.taskResponse"
		}],
		"presenter": {
			"type": "json",
			"vars": "{$data.taskResponse}"
		}
	}, {
		"path": "update.json",
		"prepare": ["session", "user"],
		"tasks": [{
			"className":  "task/mongoRequest",
			"connector":  "mongo",
			"method":     "update",
			"collection": "users",
			"data":       "{$request.body.fields}",
			"produce":    "data.updatedId"
		}, {
			"className":  "task/mongoRequest",
			"connector":  "mongo",
			"collection": "users",
			"filter":      "{$data.updatedId}",
			"options": {
				"fields": {
					"shared": 0
				}
			},
			"produce":    "data.records"
		}],
		"presenter": {
			"type": "json",
			"vars": "{$data.records}"
		}
	}]
}]
